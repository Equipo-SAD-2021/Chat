<html>
    <head>
        <title>Socket.IO chat - login</title>
    </head>
    <body>
        <form action="">
            <input type="text" name="nickname" id="username" placeholder="Will Smith" required>
            <input type="submit" id="login" value="Connect" onclick="sendUser();">
        </form>
        <p id="error" style='color:red'></p>
        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            var socket = io();
        
            function setUser(name) {
                socket.emit('login', name, (result) => {
                    if (result === null) {
                        document.getElementById('error').innerHTML = "Nickname invalid or already in use!";
                        document.getElementById('login').disabled = false;
                    } else {
                        window.sessionStorage["loginUUID"] = result;
                        window.location.href = "/chat";
                    }
                });
            }

            function sendUser() {
                var button = document.getElementById('login');
                if (button.disabled)
                    return false;
                button.disabled = true;
                document.getElementById('error').innerHTML = "";
                let name = document.getElementById('username').value;        
                setUser(name);
                return false;
            }
        </script>
    </body>
</html>